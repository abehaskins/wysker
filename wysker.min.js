wysker_init=function(m,u,d){function k(){c_we_rb=$(wta).val();m&&m($(c_we).attr("wysker-id"),$(wta).val())}function n(){$(wp).animate({height:0});is_editing=ch_we=c_we=!1;$(wht).html("Click to Edit");$(wh).hide();$(wht).hide()}function h(a){$(c_we).html(c_we_rb);is_editing=c_we=!1;$(wht).html("Click to Edit");$(wh).hide();$(wht).hide();l();$(wp).animate({height:0},a)}function s(){$(wta).css("width",$(window).width()-21-40);$(wt).css("width",$(window).width());j($(c_we))}function c(a,b){for(attr in a)$(b).css(attr,
a[attr])}function j(a){a&&($(wht).css("left",$(a).offset().left-5),$(wht).css("top",$(a).offset().top-5-20),$(wh).css("left",$(a).offset().left-5),$(wh).css("top",$(a).offset().top-5),$(wh).css("width",$(a).width()+8),$(wh).css("height",$(a).height()+8))}function o(a){$(wlc).html("");$(wlc).append($("<div>",{id:"wysker_line_numbers"}));c(wysker_line_number_css,wln);lines=$(wta).val().split("\n");for(i=1;i<=lines.length;i++){$(wln).append(i+"<br />");extra_lines=parseInt(lines[i-1].length/(a/8));for(p=
0;p<extra_lines;p++)$(wln).append("<br />");words=lines[i-1].split(" ");for(w=0;w<words.length;w++)1<words[w].length/(a/8)&&$(wln).append("<br />")}$(wln).css("top",-$(wta)[0].scrollTop)}function q(a,b,d,e,t,f){dialog={wysker_dialog_title:{tt:"div",_:a},wysker_dialog_question:{tt:"div",_:b},wysker_option_one:{tt:"div",cls:"wysker_dialog_option",style:"float: left",_:d},wysker_option_two:{tt:"div",cls:"wysker_dialog_option",style:"float: right",_:e}};$(wlb).fadeIn();$(wdb).fadeIn();$(wpa).html(j2h(dialog));
c(wysker_dialog_title_css,"#wysker_dialog_title");c(wysker_dialog_question_css,"#wysker_dialog_question");c(wysker_dialog_option_css,".wysker_dialog_option");$(wlb).css("left",($(window).width()-$(wlb).width())/2);$(wlb).css("top",($(window).height()-$(wlb).height())/2);$(".wysker_dialog_option").hover(function(){$(this).css("background-color","#333");$(this).css("color","white")},function(){$(this).css("background-color","white");$(this).css("color","black")});$("#wysker_option_one").click(t);$("#wysker_option_two").click(f)}
function l(){$(wlb).fadeOut("fast");$(wdb).fadeOut("fast")}function r(a){var b="",c=["img","br","param"];if("string"==typeof a)b=a+"\n";else if("object"==typeof a)for(var e in a){var d=a[e].tt;void 0==a[e].id&&(a[e].id=e);void 0!=a[e].cls&&(a[e]["class"]=a[e].cls);var f="<"+d+" ",g;for(g in a[e])value=a[e][g],value!=(""+value).replace("!","")&&(value=eval((""+value).replace("!",""))),"_"==g||"tt"==g||"cls"==g||(f+=g+'="'+value+'" ');c.indexOf(d)?(f+=">\n",b+=f,b+=r(a[e]._),b+="</"+d+">\n"):(f+="/>\n",
b+=f)}return b}j2h=function(a){try{a=JSON.parse(a)}catch(b){}return r(a)};"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,b){void 0===b&&(b=0);0>b&&(b+=this.length);0>b&&(b=0);for(var c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1});(function(){we="[wysker-id]";wh="#wysker_hover";wht="#wysker_hover_title";wp="#wysker_pane";wta="#wysker_textarea";wlc="#wysker_linecount";wt="#wysker_title";wlb="#wysker_lightbox";wdb="#wysker_darkbox";wpa="#wysker_padding";wln="#wysker_line_numbers";
is_editing=lc_we=c_we_rb=c_we=ch_we=false;d=d?d:"dark";wysker_hover_css={width:"100px",height:"100px",position:"absolute",left:"0px",top:"0px",border:"1px solid "+(d=="light"?"#fff":"#333"),"border-radius":"0px 4px 4px 4px",cursor:"pointer","z-index":"10000"};wysker_hover_title_css={height:"20px","line-height":"20px",padding:"0px 10px",position:"absolute",left:"0px",top:"0px",color:d=="light"?"black":"white","background-color":d=="light"?"#fff":"#333","border-radius":"4px 4px 0px 0px","font-family":"Ubuntu",
"font-size":"12px"};wysker_pane_css={width:"100%",height:"0px",position:"fixed",overflow:"hidden",left:"0px",bottom:"0px","background-color":"#ccc","font-family":"Ubuntu","font-size":"12px","border-top":"1px solid white","box-shadow":"0 0 1px 1px #888","z-index":"10000"};wysker_textarea_css={width:$(window).width()-21-40,height:"340px",margin:"0px 10px 10px 0px",border:"1px solid #999","border-radius":"0px 4px 4px 0px",resize:"none",padding:"5px","border-left":"none",outline:"none","float":"right"};
wysker_linecount_css={width:"28px","background-color":"#333","border-radius":"4px 0px 0px 4px","float":"left",height:"345px",margin:"00px 0px 0px 10px",border:"1px solid #333",color:"white","text-align":"center","padding-top":"5px",overflow:"hidden"};wysker_line_number_css={position:"relative"};wysker_button_css={width:"60px",height:"29px","background-color":"#333",color:"white","text-align":"center","line-height":"30px",cursor:"pointer",margin:"5px 10px","border-radius":"4px"};wysker_darkbox_css=
{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%","background-color":"#333",opacity:"0.5","z-index":"10000"};wysker_lightbox_css={position:"fixed",left:"0px",top:"0px",width:"300px","min-height":"100px","background-color":"white","border-radius":"4px",border:"1px solid #666","box-shadow":"0 0 5px 1px #aaa",color:"black","z-index":"10000"};wysker_padding_css={padding:"10px","font-family":"Ubuntu","font-size":"12px"};wysker_title_css={background:"-webkit-gradient(linear, left top, left bottom, from(#f0f0f0), to(#ccc))",
width:$(window).width(),height:"39px"};wysker_dialog_title_css={"font-size":"13px","border-bottom":"1px solid #ccc","padding-bottom":"4px","margin-bottom":"4px"};wysker_dialog_question_css={"border-bottom":"1px solid #ccc","padding-bottom":"4px","margin-bottom":"4px","padding-left":"4px"};wysker_dialog_option_css={cursor:"pointer",padding:"5px","border-radius":"4px","margin-bottom":"4px"};wysker_pane={wysker_pane:{tt:"div",_:{wysker_title:{tt:"div",_:{wysker_cancel:{tt:"div",cls:"wysker_button",style:"float: left;",
_:"Cancel"},wysker_save:{tt:"div",cls:"wysker_button",style:"float: right;",_:"Save"}}},wysker_linecount:{tt:"div",_:""},wysker_textarea:{tt:"textarea"}}}};wysker_dialog={wysker_darkbox:{tt:"div",_:""},wysker_lightbox:{tt:"div",_:{wysker_padding:{tt:"div",_:""}}}};$("body").append('<div id="wysker_hover_title">Click to Edit</div>');$("body").append('<div id="wysker_hover">');$("head").append("<link href='http://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>");$("body").append(j2h(wysker_pane));
$("body").append(j2h(wysker_dialog));$(wh).hide();$(wht).hide();$(wlb).hide();$(wdb).hide();c(wysker_hover_css,wh);c(wysker_pane_css,wp);c(wysker_textarea_css,wta);c(wysker_title_css,wt);c(wysker_button_css,".wysker_button");c(wysker_hover_title_css,wht);c(wysker_linecount_css,wlc);c(wysker_darkbox_css,"#wysker_darkbox");c(wysker_lightbox_css,"#wysker_lightbox");c(wysker_padding_css,"#wysker_padding");$(window).resize(s);$(we).click(function(){});$(we).hover(function(){$(wh).show();$(wht).show();
j(this);ch_we=this;ch_we==c_we?$(wht).html("Editing..."):$(wht).html("Click to Edit")},function(){});$(wh).click(function(){function a(){$(lc_we).mouseover();$(wh).click()}lc_we=ch_we;if(is_editing&&c_we!=ch_we)c_we_rb!=$(c_we).html()?q("Discard all changes?","If you choose to switch elements without saving, your changes will be lost.","Discard","Save",function(){h(a)},function(){k();l();a()}):h(a);else{c_we=ch_we;c_we_rb=$(c_we).html();is_editing=true;$(wht).html("Editing...");$(wp).animate({height:400},
"fast",function(){$(wta)[0].focus()})}$(wta).val($(c_we).html());o($(wta).width())});$(wh).hover(function(){},function(){if(is_editing)$(wht).html("Editing...");else{$(this).hide();$(wht).hide()}if(ch_we!=c_we){j(c_we);ch_we=c_we}});$(wta).keyup(function(){$(c_we).html($(wta).val());j(c_we);o($(wta).width())});$("#wysker_cancel").click(function(){c_we_rb!=$(c_we).html()?q("Discard all changes?","If you choose to cancel without saving, your changes will be lost.","Discard","Save",function(){h()},function(){k();
n();l()}):h()});$("#wysker_save").click(function(){k();n()});$(wta).scroll(function(a){$(wln).css("top",-a.target.scrollTop)})})()};